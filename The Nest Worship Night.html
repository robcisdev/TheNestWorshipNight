<!DOCTYPE html><html lang="en"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Nest - Worship Session</title>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #ffffff;
            --bg-secondary: #f5f5f7;
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --accent: #0071e3;
            --accent-hover: #0077ed;
            --gradient-1: #7928ca;
            --gradient-2: #ff0080;
            --card-bg: #ffffff;
            --border: rgba(0, 0, 0, 0.08);
        }

        .dark {
            --bg: #000000;
            --bg-secondary: #1d1d1f;
            --text-primary: #f5f5f7;
            --text-secondary: #86868b;
            --accent: #2997ff;
            --accent-hover: #40a9ff;
            --card-bg: #1d1d1f;
            --border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text-primary);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            position: relative;
            background: var(--bg);
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;
            background: radial-gradient(ellipse at 50% 50%, rgba(121, 40, 202, 0.08) 0%, transparent 50%),
                        radial-gradient(ellipse at 80% 20%, rgba(255, 0, 128, 0.06) 0%, transparent 40%);
            animation: float 20s ease-in-out infinite;
        }

        .dark .hero::before {
            background: radial-gradient(ellipse at 50% 50%, rgba(121, 40, 202, 0.15) 0%, transparent 50%),
                        radial-gradient(ellipse at 80% 20%, rgba(255, 0, 128, 0.1) 0%, transparent 40%);
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(5deg); }
            66% { transform: translate(-20px, 20px) rotate(-5deg); }
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .overline {
            font-size: 1.25rem;
            font-weight: 500;
            letter-spacing: 0.02em;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeUp 1s ease 0.2s forwards;
        }

        .hero h1 {
            font-size: clamp(3.5rem, 12vw, 7rem);
            font-weight: 700;
            letter-spacing: -0.03em;
            line-height: 1.05;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            opacity: 0;
            animation: fadeUp 1s ease 0.4s forwards;
        }

        .hero-subtitle {
            font-size: clamp(1.25rem, 3vw, 1.75rem);
            font-weight: 400;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 2.5rem;
            opacity: 0;
            animation: fadeUp 1s ease 0.6s forwards;
        }

        .hero-meta {
            display: flex;
            justify-content: center;
            gap: 3rem;
            flex-wrap: wrap;
            opacity: 0;
            animation: fadeUp 1s ease 0.8s forwards;
        }

        .meta-item {
            text-align: center;
        }

        .meta-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .meta-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .scroll-indicator {
            position: absolute;
            bottom: 3rem;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            animation: fadeUp 1s ease 1s forwards, bounce 2s ease-in-out 2s infinite;
        }

        .scroll-indicator svg {
            width: 24px;
            height: 24px;
            stroke: var(--text-secondary);
        }

        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(10px); }
        }

        /* Sections */
        section {
            padding: 8rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-label {
            font-size: 1rem;
            font-weight: 500;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
        }

        .section-title {
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 700;
            letter-spacing: -0.02em;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        .section-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            max-width: 700px;
            margin-bottom: 4rem;
        }

        /* Schedule Actions */
        .schedule-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .schedule-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .schedule-btn:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .schedule-btn svg {
            flex-shrink: 0;
        }

        .load-btn {
            cursor: pointer;
        }

        .drag-hint {
            margin-left: auto;
            font-size: 0.8rem;
            color: var(--text-secondary);
            opacity: 0.7;
        }

        /* Timeline */
        .timeline-container {
            background: var(--bg-secondary);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 4rem;
        }

        .timeline-grid {
            display: grid;
            gap: 0;
        }

        /* Drag and Drop Styles */
        .timeline-item {
            cursor: grab;
            user-select: none;
        }

        .timeline-item:active {
            cursor: grabbing;
        }

        .timeline-item.dragging {
            opacity: 0.5;
            background: var(--accent);
            border-radius: 12px;
        }

        .timeline-item.drag-over {
            border-top: 3px solid var(--accent);
            margin-top: -3px;
        }

        .timeline-item .drag-handle {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            color: var(--text-secondary);
            opacity: 0.4;
            transition: opacity 0.2s;
            margin-right: 0.5rem;
            flex-shrink: 0;
        }

        .timeline-item:hover .drag-handle {
            opacity: 1;
        }

        .timeline-item {
            display: grid;
            grid-template-columns: 140px 1fr;
            gap: 2rem;
            padding: 2rem 0;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .timeline-item:last-child {
            border-bottom: none;
        }

        .timeline-item:hover {
            transform: translateX(8px);
        }

        .timeline-time {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .timeline-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .timeline-content p {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .timeline-tag {
            display: inline-block;
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 100px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 0.75rem;
        }

        .responsible-field {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .responsible-field label {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .responsible-field input {
            flex: 1;
            padding: 0.4rem 0.75rem;
            font-size: 0.9rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg);
            color: var(--text-primary);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            max-width: 200px;
        }

        .responsible-field input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.15);
        }

        .responsible-field input::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }

        /* Slideshow Section */
        .slideshow-section {
            padding: 6rem 0;
            background: var(--bg-secondary);
            overflow: hidden;
        }

        .slideshow-header {
            text-align: center;
            max-width: 1200px;
            margin: 0 auto 4rem;
            padding: 0 2rem;
        }

        .slideshow-container {
            position: relative;
            max-width: 900px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .slides-wrapper {
            position: relative;
            overflow: hidden;
            border-radius: 32px;
            background: var(--card-bg);
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.15);
        }

        .dark .slides-wrapper {
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.5);
        }

        .slides-track {
            display: flex;
            transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .slide {
            min-width: 100%;
            padding: 4rem 3rem;
            opacity: 0.3;
            transform: scale(0.95);
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .slide.active {
            opacity: 1;
            transform: scale(1);
        }

        .slide-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            border-radius: 50%;
            color: white;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 2rem;
        }

        .slide-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            display: block;
        }

        .slide h3 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
        }

        .slide > p {
            font-size: 1.25rem;
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 1.5rem;
            max-width: 600px;
        }

        .slide-content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .slide-verses {
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            border-radius: 20px;
            padding: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .slide-verses::before {
            content: '"';
            position: absolute;
            top: -20px;
            left: 10px;
            font-size: 6rem;
            opacity: 0.15;
            font-family: Georgia, serif;
            line-height: 1;
        }

        .slide-verses h4 {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            opacity: 0.8;
            margin-bottom: 1rem;
        }

        .verse-item {
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .verse-item:last-child {
            margin-bottom: 0;
        }

        .verse-item p {
            font-size: 1.15rem;
            font-style: italic;
            line-height: 1.7;
            margin-bottom: 0.35rem;
        }

        .verse-ref {
            font-size: 0.95rem;
            font-weight: 600;
            opacity: 0.85;
        }

        /* Cautions Section - Hidden by default */
        .cautions-toggle {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            transition: all 0.3s ease;
            width: 100%;
            justify-content: center;
        }

        .cautions-toggle:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .cautions-toggle .arrow {
            transition: transform 0.3s ease;
        }

        .cautions-toggle.open .arrow {
            transform: rotate(180deg);
        }

        .cautions-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, margin 0.4s ease, opacity 0.4s ease;
            opacity: 0;
            margin-top: 0;
        }

        .cautions-content.open {
            max-height: 500px;
            opacity: 1;
            margin-top: 1rem;
        }

        .cautions-list {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1));
            border-radius: 12px;
            padding: 1rem 1.25rem;
            border-left: 4px solid #ff6b35;
        }

        .dark .cautions-list {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(247, 147, 30, 0.2));
        }

        .cautions-list h5 {
            font-size: 0.9rem;
            font-weight: 600;
            color: #ff6b35;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .cautions-list ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .cautions-list ul li {
            font-size: 0.9rem;
            color: var(--text-primary);
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border);
            line-height: 1.5;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .cautions-list ul li:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .cautions-list ul li::before {
            content: '⚠️';
            flex-shrink: 0;
        }

        .slide-interactive {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .dark .slide-interactive {
            background: var(--bg);
        }

        .slide-interactive h4 {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--accent);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .activity-box {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border);
        }

        .activity-box h5 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .activity-box p {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .questions-box h5 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .questions-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .questions-list li {
            font-size: 0.85rem;
            color: var(--text-secondary);
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border);
            line-height: 1.5;
        }

        .questions-list li:last-child {
            border-bottom: none;
        }

        .questions-list li::before {
            content: '→';
            color: var(--accent);
            margin-right: 0.5rem;
        }

        /* Reveal hint - hidden by default in normal mode */
        .reveal-hint {
            display: none;
            text-align: center;
            padding: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-style: italic;
            opacity: 0.7;
        }

        .reveal-hint.hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .slide-content-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Summary Slide */
        .summary-slide {
            text-align: center;
        }

        .summary-slide h3 {
            margin-bottom: 2rem;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            text-align: center;
        }

        .summary-item {
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .dark .summary-item {
            background: var(--bg);
        }

        .summary-item:hover {
            transform: translateY(-4px);
        }

        .summary-icon {
            font-size: 2rem;
            margin-bottom: 0.75rem;
            display: block;
        }

        .summary-title {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-primary);
        }

        /* Slideshow Navigation */
        .slide-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin-top: 3rem;
        }

        .slide-arrow {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            background: var(--card-bg);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px var(--border);
        }

        .slide-arrow:hover {
            background: var(--accent);
            color: white;
            transform: scale(1.1);
        }

        .slide-arrow:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: none;
        }

        .slide-arrow svg {
            width: 24px;
            height: 24px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .slide-dots {
            display: flex;
            gap: 10px;
        }

        .slide-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: none;
            background: var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
        }

        .slide-dot.active {
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            width: 32px;
            border-radius: 10px;
        }

        .slide-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gradient-1), var(--gradient-2));
            border-radius: 0 0 0 32px;
            transition: width 0.3s ease;
        }

        .slide-counter {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Responsive Reading Section */
        .responsive-reading-section {
            background: linear-gradient(180deg, var(--bg) 0%, var(--bg-secondary) 100%);
            padding: 6rem 2rem;
        }

        .responsive-reading-wrapper {
            max-width: 900px;
            margin: 0 auto;
        }

        .responsive-reading-content {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 2rem;
        }

        .reading-verse {
            padding: 1rem 1.25rem;
            border-radius: 12px;
            transition: transform 0.2s ease;
        }

        .reading-verse:hover {
            transform: translateX(4px);
        }

        .reading-verse.ladies {
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.1), rgba(219, 39, 119, 0.05));
            border-left: 4px solid #ec4899;
        }

        .reading-verse.men {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05));
            border-left: 4px solid #3b82f6;
        }

        .reading-verse.all {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(99, 102, 241, 0.1));
            border-left: 4px solid var(--accent);
            padding: 1.25rem 1.5rem;
        }

        .reader-label {
            display: inline-block;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
            opacity: 0.8;
        }

        .reading-verse.ladies .reader-label {
            color: #ec4899;
        }

        .reading-verse.ladies .verse-text {
            color: #db2777;
        }

        .dark .reading-verse.ladies .verse-text {
            color: #f472b6;
        }

        .reading-verse.men .reader-label {
            color: #3b82f6;
        }

        .reading-verse.all .reader-label {
            color: var(--accent);
            font-size: 0.85rem;
        }

        .verse-text {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin: 0;
        }

        .verse-text strong {
            font-weight: 600;
        }

        .reading-verse.ladies .verse-text strong {
            color: #db2777;
        }

        .dark .reading-verse.ladies .verse-text strong {
            color: #f472b6;
        }

        .reading-verse.men .verse-text strong {
            color: #2563eb;
        }

        .dark .reading-verse.men .verse-text strong {
            color: #60a5fa;
        }

        .reading-verse.all .verse-text strong {
            color: var(--accent);
        }

        .reading-verse.all .verse-text {
            font-size: 1.2rem;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .responsive-reading-section {
                padding: 4rem 1.5rem;
            }

            .reading-verse {
                padding: 0.85rem 1rem;
            }

            .verse-text {
                font-size: 1rem;
            }
        }

        /* Songs Section */
        .songs-section {
            background: var(--bg);
            padding: 8rem 2rem;
        }

        .songs-wrapper {
            max-width: 1200px;
            margin: 0 auto;
        }

        .songs-grid {
            display: grid;
            gap: 1px;
            background: var(--border);
            border-radius: 20px;
            overflow: hidden;
        }

        .song-item {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1.5rem 2rem;
            background: var(--bg-secondary);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .song-item:hover {
            background: var(--accent);
        }

        .song-item:hover .song-number,
        .song-item:hover .song-title,
        .song-item:hover .song-artist {
            color: white;
        }

        .song-item:hover .play-icon {
            opacity: 1;
            transform: scale(1);
        }

        .song-number {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-secondary);
            width: 32px;
            transition: color 0.3s ease;
        }

        .song-info {
            flex: 1;
        }

        .song-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            transition: color 0.3s ease;
        }

        .song-artist {
            font-size: 0.875rem;
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }

        .play-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
        }

        .play-icon svg {
            width: 16px;
            height: 16px;
            fill: white;
            margin-left: 2px;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
            background: var(--bg);
        }

        footer p {
            font-size: 1.125rem;
            font-weight: 400;
        }

        /* Responsive */
        @media (max-width: 768px) {
            section {
                padding: 5rem 1.5rem;
            }

            .hero {
                padding: 1.5rem;
            }

            .hero-meta {
                gap: 2rem;
            }

            .timeline-container {
                padding: 1.5rem;
            }

            .timeline-item {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .timeline-time {
                font-size: 1.125rem;
                color: var(--accent);
            }

            .timeline-content h3 {
                font-size: 1.25rem;
            }

            .responsible-field {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.25rem;
            }

            .responsible-field input {
                max-width: 100%;
                width: 100%;
            }

            .slideshow-section {
                padding: 4rem 0;
            }

            .slide {
                padding: 2.5rem 1.5rem;
            }

            .slide h3 {
                font-size: 1.75rem;
            }

            .slide > p {
                font-size: 1rem;
            }

            .slide-icon {
                font-size: 3rem;
            }

            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }

            .slide-nav {
                gap: 1rem;
            }

            .slide-arrow {
                width: 48px;
                height: 48px;
            }

            .songs-section {
                padding: 5rem 1.5rem;
            }

            .song-item {
                padding: 1.25rem 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Scroll animations */
        .fade-in {
            opacity: 0;
            transform: translateY(40px);
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }


        /* Presenter Mode Toggle */
        .presenter-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 100px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 8px 32px rgba(121, 40, 202, 0.3);
            transition: all 0.3s ease;
        }

        .presenter-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 40px rgba(121, 40, 202, 0.4);
        }

        .presenter-toggle svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        /* Presenter Mode Styles */
        body.presenter-mode {
            overflow: hidden;
        }

        body.presenter-mode .hero,
        body.presenter-mode section:not(.presenter-section),
        body.presenter-mode .songs-section,
        body.presenter-mode footer,
        body.presenter-mode .slideshow-header,
        body.presenter-mode .bible-slideshow-header {
            display: none !important;
        }

        /* Hide non-active slideshow in presenter mode */
        body.presenter-mode.worship-presenter .bible-slideshow-section {
            display: none !important;
        }

        body.presenter-mode.bible-presenter .slideshow-section {
            display: none !important;
        }

        body.presenter-mode .slideshow-section,
        body.presenter-mode .bible-slideshow-section {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            padding: 0;
            z-index: 999;
            display: flex;
            flex-direction: column;
            background: var(--bg);
        }

        body.presenter-mode .slideshow-container {
            max-width: 100%;
            height: 100vh;
            padding: 1rem 2rem;
            display: flex;
            flex-direction: column;
        }

        body.presenter-mode .slides-wrapper {
            flex: 1;
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
            min-height: 0;
        }

        body.presenter-mode .slides-track {
            height: 100%;
        }

        body.presenter-mode .slide {
            padding: 1.5rem 3rem;
            height: 100%;
            overflow-y: auto;
            display: block;
        }

        body.presenter-mode .slide-number {
            width: 48px;
            height: 48px;
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
        }

        body.presenter-mode .slide-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        body.presenter-mode .slide h3 {
            font-size: clamp(2rem, 4vw, 3rem);
            margin-bottom: 0.5rem;
        }

        body.presenter-mode .slide > p {
            font-size: clamp(1.1rem, 1.8vw, 1.4rem);
            max-width: 900px;
            margin-bottom: 1rem;
        }

        body.presenter-mode .slide-content-grid {
            gap: 1.5rem;
            margin-top: 1rem;
            align-items: start;
        }

        body.presenter-mode .slide-verses {
            padding: 1.25rem;
        }

        body.presenter-mode .slide-verses h4 {
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }

        body.presenter-mode .verse-item {
            margin-bottom: 0.75rem;
        }

        body.presenter-mode .verse-item p {
            font-size: 0.95rem;
            line-height: 1.6;
        }

        body.presenter-mode .verse-ref {
            font-size: 0.85rem;
        }

        body.presenter-mode .slide-interactive {
            padding: 1.25rem;
        }

        body.presenter-mode .slide-interactive h4 {
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }

        body.presenter-mode .activity-box {
            padding: 0.875rem;
            margin-bottom: 0.75rem;
        }

        body.presenter-mode .activity-box h5 {
            font-size: 0.95rem;
            margin-bottom: 0.35rem;
        }

        body.presenter-mode .activity-box p {
            font-size: 0.85rem;
            line-height: 1.5;
        }

        /* Large Verses for TV Display */
        body.presenter-mode .slide-verses {
            padding: 1.5rem;
        }

        body.presenter-mode .slide-verses h4 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        body.presenter-mode .verse-item {
            margin-bottom: 1.25rem;
        }

        body.presenter-mode .verse-item p {
            font-size: clamp(1.3rem, 2.2vw, 1.8rem);
            line-height: 1.6;
        }

        body.presenter-mode .verse-ref {
            font-size: clamp(1rem, 1.5vw, 1.2rem);
        }

        /* Large Questions for TV Display - One by One Reveal */
        body.presenter-mode .questions-box h5 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        body.presenter-mode .questions-list li {
            font-size: clamp(1.4rem, 2.5vw, 2rem);
            padding: 1rem 0;
            line-height: 1.4;
            color: var(--text-primary);
            font-weight: 500;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            cursor: pointer;
        }

        body.presenter-mode .questions-list li.revealed {
            opacity: 1;
            transform: translateY(0);
        }

        body.presenter-mode .questions-list li.revealed:hover {
            color: var(--accent);
        }

        body.presenter-mode .questions-list li::before {
            font-size: 1.5rem;
            margin-right: 0.75rem;
        }

        /* Question reveal hint */
        body.presenter-mode .reveal-hint {
            display: block;
            text-align: center;
            padding: 1rem;
            color: var(--text-secondary);
            font-size: 1rem;
            font-style: italic;
            opacity: 0.7;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        body.presenter-mode .reveal-hint:hover {
            opacity: 1;
            color: var(--accent);
        }

        body.presenter-mode .reveal-hint.hidden {
            display: none;
        }

        body.presenter-mode .slide-nav {
            margin-top: 0.75rem;
            gap: 2rem;
            flex-shrink: 0;
            padding: 0.5rem 0;
        }

        body.presenter-mode .slide-arrow {
            width: 56px;
            height: 56px;
        }

        body.presenter-mode .slide-arrow svg {
            width: 24px;
            height: 24px;
        }

        body.presenter-mode .slide-dot {
            width: 12px;
            height: 12px;
        }

        body.presenter-mode .slide-dot.active {
            width: 36px;
        }

        body.presenter-mode .slide-counter {
            font-size: 1rem;
            margin-top: 0.5rem;
            flex-shrink: 0;
        }

        /* Summary slide in presenter mode */
        body.presenter-mode .summary-slide h3 {
            font-size: clamp(2rem, 4vw, 3rem);
        }

        body.presenter-mode .summary-slide > p {
            font-size: clamp(1.1rem, 1.8vw, 1.4rem);
        }

        body.presenter-mode .summary-grid {
            gap: 1rem;
        }

        body.presenter-mode .summary-item {
            padding: 1.25rem;
        }

        body.presenter-mode .summary-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        body.presenter-mode .summary-title {
            font-size: 1rem;
        }

        /* Exit presenter button */
        .exit-presenter {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 1001;
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--border);
            padding: 0.75rem 1.25rem;
            border-radius: 100px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            display: none;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        body.presenter-mode .exit-presenter {
            display: flex;
        }

        .exit-presenter:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        /* Hide toggle in presenter mode */
        body.presenter-mode .presenter-toggle {
            display: none;
        }

        /* Presenter mode responsive */
        @media (max-width: 1024px) {
            body.presenter-mode .slide {
                padding: 2rem;
            }

            body.presenter-mode .slide-content-grid {
                grid-template-columns: 1fr;
                overflow-y: auto;
            }

            body.presenter-mode .questions-list li {
                font-size: 1.25rem;
            }
        }

        /* Bible Study Slideshow */
        .bible-slideshow-section {
            padding: 6rem 0;
            background: var(--bg);
            overflow: hidden;
        }

        .bible-slideshow-header {
            text-align: center;
            max-width: 1200px;
            margin: 0 auto 4rem;
            padding: 0 2rem;
        }

        .bible-slideshow-container {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .bible-slides-wrapper {
            position: relative;
            overflow: hidden;
            border-radius: 32px;
            background: var(--card-bg);
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.12);
            border: 1px solid var(--border);
        }

        .dark .bible-slides-wrapper {
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.5);
        }

        .bible-slides-track {
            display: flex;
            transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .bible-slide {
            min-width: 100%;
            padding: 3rem;
            opacity: 0.3;
            transform: scale(0.95);
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .bible-slide.active {
            opacity: 1;
            transform: scale(1);
        }

        .bible-slide-header {
            display: flex;
            align-items: flex-start;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .bible-slide-icon {
            width: 72px;
            height: 72px;
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.25rem;
            flex-shrink: 0;
        }

        .bible-slide-title-group {
            flex: 1;
        }

        .bible-slide-number {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }

        .bible-slide h3 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
            line-height: 1.2;
        }

        .bible-slide-description {
            font-size: 1.125rem;
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 2rem;
            max-width: 800px;
        }

        .bible-slide-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .bible-verse-card {
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            border-radius: 20px;
            padding: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .bible-verse-card::before {
            content: '"';
            position: absolute;
            top: -15px;
            left: 10px;
            font-size: 5rem;
            opacity: 0.15;
            font-family: Georgia, serif;
            line-height: 1;
        }

        .bible-verse-card h4 {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            opacity: 0.85;
            margin-bottom: 1rem;
        }

        .bible-verse-item {
            margin-bottom: 1.25rem;
            position: relative;
            z-index: 1;
        }

        .bible-verse-item:last-child {
            margin-bottom: 0;
        }

        .bible-verse-item p {
            font-size: 1rem;
            font-style: italic;
            line-height: 1.7;
            margin-bottom: 0.35rem;
        }

        .bible-verse-item .verse-ref {
            font-size: 0.85rem;
            font-weight: 600;
            opacity: 0.9;
        }

        .bible-keypoint-card {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .dark .bible-keypoint-card {
            background: var(--bg);
        }

        .bible-keypoint-card h4 {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--accent);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .bible-keypoint-item {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            border: 1px solid var(--border);
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .bible-keypoint-item:last-child {
            margin-bottom: 0;
        }

        .bible-keypoint-item span:first-child {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .bible-keypoint-item p {
            font-size: 0.95rem;
            color: var(--text-primary);
            line-height: 1.6;
            margin: 0;
        }

        .reflect-comment {
            font-size: 1rem;
            line-height: 1.7;
            color: var(--text-secondary);
            font-style: italic;
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.08), rgba(99, 102, 241, 0.05));
            border-left: 3px solid var(--accent);
            border-radius: 0 8px 8px 0;
        }

        .reflect-comment strong {
            color: var(--accent);
            font-style: normal;
        }

        .bible-questions-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .bible-questions-list li {
            font-size: 1rem;
            color: var(--text-primary);
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border);
            line-height: 1.5;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .bible-questions-list li:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .bible-questions-list li::before {
            content: '→';
            color: var(--accent);
            font-weight: bold;
            flex-shrink: 0;
        }

        /* Bible Slide Steps (for How to Celebrate) */
        .bible-steps-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .bible-step-item {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 1.25rem;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .dark .bible-step-item {
            background: var(--bg);
        }

        .bible-step-item:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .bible-step-number {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }

        .bible-step-item h5 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .bible-step-item p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 0.5rem;
        }

        .bible-step-item .verse-ref {
            font-size: 0.8rem;
            color: var(--accent);
            font-weight: 600;
        }

        /* Warning Slide */
        .bible-slide-warning {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            border-radius: 20px;
            padding: 2rem;
            color: white;
        }

        .bible-slide-warning h4 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .bible-slide-warning p {
            font-size: 1rem;
            line-height: 1.7;
            opacity: 0.95;
            margin-bottom: 1rem;
        }

        .bible-slide-warning .verse-ref {
            font-size: 0.9rem;
            font-weight: 600;
            opacity: 0.9;
        }

        /* Final Reading Slide */
        .bible-final-reading-box {
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            border-radius: 20px;
            padding: 2rem;
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .bible-final-reading-box::before {
            content: '"';
            position: absolute;
            top: -20px;
            left: 20px;
            font-size: 8rem;
            opacity: 0.1;
            font-family: Georgia, serif;
        }

        .bible-final-reading-box blockquote {
            font-style: italic;
            font-size: 1.1rem;
            line-height: 1.8;
            text-align: left;
            position: relative;
            z-index: 1;
            margin: 0;
        }

        .bible-final-reading-box .verse-ref {
            display: block;
            text-align: right;
            margin-top: 1rem;
            font-weight: 600;
            font-style: normal;
            opacity: 0.9;
        }

        /* Bible Summary Slide */
        .bible-summary-slide {
            text-align: center;
        }

        .bible-summary-slide h3 {
            margin-bottom: 1.5rem;
        }

        .bible-summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .bible-summary-item {
            padding: 1.25rem 1rem;
            background: var(--bg-secondary);
            border-radius: 16px;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
        }

        .dark .bible-summary-item {
            background: var(--bg);
        }

        .bible-summary-item:hover {
            transform: translateY(-4px);
            border-color: var(--accent);
        }

        .bible-summary-item .icon {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .bible-summary-item .title {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-primary);
            line-height: 1.3;
        }

        /* Bible Slideshow Navigation */
        .bible-slide-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin-top: 3rem;
        }

        .bible-slide-arrow {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            background: var(--card-bg);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px var(--border);
        }

        .bible-slide-arrow:hover {
            background: var(--accent);
            color: white;
            transform: scale(1.1);
        }

        .bible-slide-arrow:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: none;
        }

        .bible-slide-arrow:disabled:hover {
            background: var(--card-bg);
            color: var(--text-primary);
        }

        .bible-slide-arrow svg {
            width: 24px;
            height: 24px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .bible-slide-dots {
            display: flex;
            gap: 8px;
        }

        .bible-slide-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: none;
            background: var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
        }

        .bible-slide-dot.active {
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            width: 28px;
            border-radius: 10px;
        }

        .bible-slide-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gradient-1), var(--gradient-2));
            border-radius: 0 0 0 32px;
            transition: width 0.3s ease;
        }

        .bible-slide-counter {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
            text-align: center;
            margin-top: 1.5rem;
        }

        @media (max-width: 768px) {
            .bible-slide {
                padding: 2rem 1.5rem;
            }

            .bible-slide-header {
                flex-direction: column;
                gap: 1rem;
            }

            .bible-slide-icon {
                width: 56px;
                height: 56px;
                font-size: 1.75rem;
            }

            .bible-slide h3 {
                font-size: 1.5rem;
            }

            .bible-slide-description {
                font-size: 1rem;
            }

            .bible-slide-content {
                grid-template-columns: 1fr;
            }

            .bible-steps-grid {
                grid-template-columns: 1fr;
            }

            .bible-summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .bible-slide-nav {
                gap: 1rem;
            }

            .bible-slide-arrow {
                width: 48px;
                height: 48px;
            }
        }

        @media (max-width: 480px) {
            .bible-summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Bible Slideshow Presenter Mode */
        body.presenter-mode .bible-slideshow-container {
            max-width: 100%;
            height: 100vh;
            padding: 1rem 2rem;
            display: flex;
            flex-direction: column;
        }

        body.presenter-mode .bible-slides-wrapper {
            flex: 1;
            border-radius: 0;
            box-shadow: none;
            border: none;
            overflow: hidden;
            min-height: 0;
        }

        body.presenter-mode .bible-slides-track {
            height: 100%;
        }

        body.presenter-mode .bible-slide {
            padding: 1.5rem 3rem;
            height: 100%;
            overflow-y: auto;
            display: block;
        }

        body.presenter-mode .bible-slide-header {
            margin-bottom: 1.5rem;
        }

        body.presenter-mode .bible-slide-icon {
            width: 64px;
            height: 64px;
            font-size: 2rem;
        }

        body.presenter-mode .bible-slide h3 {
            font-size: clamp(1.75rem, 3.5vw, 2.5rem);
        }

        body.presenter-mode .bible-slide-number {
            font-size: 0.9rem;
        }

        body.presenter-mode .bible-slide-description {
            font-size: clamp(1.1rem, 1.8vw, 1.4rem);
            margin-bottom: 1.5rem;
        }

        body.presenter-mode .bible-slide-content {
            gap: 1.5rem;
        }

        body.presenter-mode .bible-verse-card {
            padding: 1.5rem;
        }

        body.presenter-mode .bible-verse-card h4 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        body.presenter-mode .bible-verse-item {
            margin-bottom: 1.25rem;
        }

        body.presenter-mode .bible-verse-item p {
            font-size: clamp(1.2rem, 2vw, 1.6rem);
            line-height: 1.6;
        }

        body.presenter-mode .bible-verse-item .verse-ref {
            font-size: clamp(0.95rem, 1.4vw, 1.1rem);
        }

        body.presenter-mode .bible-keypoint-card {
            padding: 1.5rem;
        }

        body.presenter-mode .bible-keypoint-card h4 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        body.presenter-mode .reflect-comment {
            font-size: clamp(1.2rem, 2vw, 1.6rem);
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
            border-left-width: 4px;
        }

        body.presenter-mode .bible-questions-list li {
            font-size: clamp(1.3rem, 2.2vw, 1.8rem);
            padding: 0.85rem 0;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            cursor: pointer;
        }

        body.presenter-mode .bible-questions-list li.revealed {
            opacity: 1;
            transform: translateY(0);
        }

        body.presenter-mode .bible-keypoint-item p {
            font-size: clamp(1.1rem, 1.8vw, 1.4rem);
        }

        body.presenter-mode .bible-steps-grid {
            gap: 1rem;
        }

        body.presenter-mode .bible-step-item h5 {
            font-size: 1.1rem;
        }

        body.presenter-mode .bible-step-item p {
            font-size: 1rem;
        }

        body.presenter-mode .bible-slide-warning {
            padding: 1.5rem;
        }

        body.presenter-mode .bible-slide-warning h4 {
            font-size: 1.3rem;
        }

        body.presenter-mode .bible-slide-warning p {
            font-size: clamp(1.1rem, 1.8vw, 1.4rem);
        }

        body.presenter-mode .bible-final-reading-box {
            padding: 2rem;
        }

        body.presenter-mode .bible-final-reading-box blockquote {
            font-size: clamp(1.2rem, 2vw, 1.6rem);
        }

        body.presenter-mode .bible-slide-nav {
            margin-top: 0.75rem;
            gap: 2rem;
            flex-shrink: 0;
            padding: 0.5rem 0;
        }

        body.presenter-mode .bible-slide-arrow {
            width: 56px;
            height: 56px;
        }

        body.presenter-mode .bible-slide-dot {
            width: 12px;
            height: 12px;
        }

        body.presenter-mode .bible-slide-dot.active {
            width: 32px;
        }

        body.presenter-mode .bible-slide-counter {
            font-size: 1rem;
            margin-top: 0.5rem;
        }

        body.presenter-mode .bible-summary-grid {
            gap: 0.75rem;
        }

        body.presenter-mode .bible-summary-item {
            padding: 1rem 0.75rem;
        }

        body.presenter-mode .bible-summary-item .icon {
            font-size: 1.5rem;
        }

        body.presenter-mode .bible-summary-item .title {
            font-size: 0.8rem;
        }

        /* Second presenter toggle for Bible Study */
        .presenter-toggle-bible {
            position: fixed;
            bottom: 2rem;
            right: 16rem;
            z-index: 1000;
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 100px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 8px 32px rgba(255, 107, 53, 0.3);
            transition: all 0.3s ease;
        }

        @media (max-width: 768px) {
            .presenter-toggle {
                bottom: 6rem;
                right: 1rem;
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }

            .presenter-toggle-bible {
                bottom: 2rem;
                right: 1rem;
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
        }

        .presenter-toggle-bible:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 40px rgba(255, 107, 53, 0.4);
        }

        .presenter-toggle-bible svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        body.presenter-mode .presenter-toggle-bible {
            display: none;
        }

        /* Popup presenter toggle button */
        .presenter-toggle-popup {
            position: fixed;
            bottom: 2rem;
            right: 30rem;
            z-index: 1000;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 100px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 8px 30px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
        }

        @media (max-width: 1200px) {
            .presenter-toggle-popup {
                bottom: 8rem;
                right: 1rem;
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
        }

        .presenter-toggle-popup:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 40px rgba(16, 185, 129, 0.4);
        }

        .presenter-toggle-popup svg {
            width: 20px;
            height: 20px;
        }

        body.presenter-mode .presenter-toggle-popup {
            display: none;
        }

        /* Controller panel for popup presenter */
        .presenter-controller {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, transparent, rgba(0,0,0,0.95));
            padding: 2rem;
            z-index: 2000;
        }

        .presenter-controller.active {
            display: block;
        }

        .controller-inner {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            box-shadow: 0 -10px 40px rgba(0,0,0,0.3);
        }

        .controller-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .controller-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .controller-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            color: #10b981;
        }

        .controller-status::before {
            content: '';
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .controller-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .controller-section {
            background: var(--bg);
            padding: 1rem;
            border-radius: 12px;
        }

        .controller-section h4 {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
        }

        .controller-btns {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .ctrl-btn {
            padding: 0.6rem 1rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .ctrl-btn.primary {
            background: var(--accent);
            color: white;
        }

        .ctrl-btn.primary:hover {
            filter: brightness(1.1);
        }

        .ctrl-btn.secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .ctrl-btn.secondary:hover {
            background: var(--border);
        }

        .ctrl-btn.danger {
            background: #ef4444;
            color: white;
        }

        .ctrl-btn.danger:hover {
            background: #dc2626;
        }

        .current-slide-info {
            font-size: 1rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .slide-counter-ctrl {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Section label for presenter mode */
        .presenter-section-label {
            position: fixed;
            top: 1.5rem;
            left: 1.5rem;
            z-index: 1001;
            background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 100px;
            font-size: 0.85rem;
            font-weight: 600;
            display: none;
        }

        body.presenter-mode .presenter-section-label {
            display: block;
        }

        body.presenter-mode.worship-presenter .presenter-section-label.bible-label {
            display: none;
        }

        body.presenter-mode.bible-presenter .presenter-section-label.worship-label {
            display: none;
        }

        @media (max-width: 1024px) {
            body.presenter-mode .bible-slide {
                padding: 2rem;
            }

            body.presenter-mode .bible-slide-content {
                grid-template-columns: 1fr;
            }

            body.presenter-mode .bible-questions-list li {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Presenter Mode Toggle Buttons -->
    <button class="presenter-toggle" id="presenterToggle" aria-label="Enter Presenter Mode">
        <svg viewBox="0 0 24 24"><path d="M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5v2h8v-2h5c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 14H3V5h18v12z"></path></svg>
        Worship Expressions
    </button>
    <button class="presenter-toggle-bible" id="presenterToggleBible" aria-label="Enter Bible Study Presenter Mode">
        <svg viewBox="0 0 24 24"><path d="M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5v2h8v-2h5c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 14H3V5h18v12z"></path></svg>
        Lord's Supper
    </button>
    <button class="presenter-toggle-popup" id="presenterPopupToggle" aria-label="Open Presenter in New Window">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="3" width="20" height="14" rx="2"></rect>
            <path d="M8 21h8M12 17v4"></path>
            <path d="M9 10l3-3 3 3M12 7v6"></path>
        </svg>
        Open in New Window
    </button>

    <!-- Section Labels for Presenter Mode -->
    <div class="presenter-section-label worship-label">🎵 Worship Expressions</div>
    <div class="presenter-section-label bible-label">✝️ The Lord's Supper</div>

    <!-- Exit Presenter Button -->
    <button class="exit-presenter" id="exitPresenter" aria-label="Exit Presenter Mode">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        Exit
    </button>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <p class="overline">Friday Night Fellowship</p>
            <h1>The Nest</h1>
            <p class="hero-subtitle">A sacred space for worship, community, and encountering God together.</p>
            <div class="hero-meta">
                <div class="meta-item">
                    <div class="meta-value">7:30</div>
                    <div class="meta-label">Start Time</div>
                </div>
                <div class="meta-item">
                    <div class="meta-value">1</div>
                    <div class="meta-label">Hour</div>
                </div>
                <div class="meta-item">
                    <div class="meta-value">7</div>
                    <div class="meta-label">Songs</div>
                </div>
            </div>
        </div>
        <div class="scroll-indicator">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round">
                <path d="M12 5v14M5 12l7 7 7-7"></path>
            </svg>
        </div>
    </section>

    <!-- Schedule Section -->
    <section class="fade-in schedule-section">
        <p class="section-label">Schedule</p>
        <h2 class="section-title">The Greatness &amp;<br>Goodness of God</h2>
        <p class="section-subtitle">From opening worship to benediction, every moment is designed to draw you closer.</p>

        <div class="schedule-actions">
            <button class="schedule-btn" id="saveScheduleBtn">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                    <polyline points="17 21 17 13 7 13 7 21"></polyline>
                    <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
                Save Schedule
            </button>
            <label class="schedule-btn load-btn">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                Load Schedule
                <input type="file" id="loadScheduleInput" accept=".json" hidden="">
            </label>
            <span class="drag-hint">✋ Drag items to reorder</span>
        </div>

        <div class="timeline-container">
            <div class="timeline-grid" id="timelineGrid">
                <div class="timeline-item">
                    <div class="timeline-time">7:30 PM</div>
                    <div class="timeline-content">
                        <h3>Welcome &amp; Opening Prayer</h3>
                        <p>Setting the tone—be still and open your heart before the Lord</p>
                        <span class="timeline-tag">Opening</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="SAM">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">7:33 PM</div>
                    <div class="timeline-content">
                        <h3>Apostle's Creed</h3>
                        <p>Affirming our beliefs together as one body (10 min)</p>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="GORDON / NEIL">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">7:36 PM</div>
                    <div class="timeline-content">
                        <h3>🎵 Goodness of God + Firm Foundation</h3>
                        <p>Bethel Music / Cody Carnes — Focus on God's faithfulness and mercy</p>
                        <span class="timeline-tag">Worship</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="WORSHIP TEAM">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">7:40 PM</div>
                    <div class="timeline-content">
                        <h3>Declaration 1</h3>
                        <p>Personal declaration of who God is now in their life (10 min)</p>
                        <span class="timeline-tag">Testimony</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="CASEY">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">7:44 PM</div>
                    <div class="timeline-content">
                        <h3>🎵 Nothing Else</h3>
                        <p>Cody Carnes</p>
                        <span class="timeline-tag">Worship</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="WORSHIP TEAM">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">7:48 PM</div>
                    <div class="timeline-content">
                        <h3>Declaration 2</h3>
                        <p>Personal declaration of God's greatness and goodness (10 min)</p>
                        <span class="timeline-tag">Testimony</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="CHRIS / LYDIA">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">7:52 PM</div>
                    <div class="timeline-content">
                        <h3>🎵 Bless The Lord (10,000 Reasons)</h3>
                        <p>Matt Redman — Ties to Scripture reading</p>
                        <span class="timeline-tag">Worship</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="WORSHIP TEAM">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">7:55 PM</div>
                    <div class="timeline-content">
                        <h3>Scripture Reading</h3>
                        <p>Psalm 103:1-22 — God's power, mercy, and faithfulness</p>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="ALL">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">7:58 PM</div>
                    <div class="timeline-content">
                        <h3>📖 Seven Expressions of Worship</h3>
                        <p>Teaching on the biblical expressions of worship — Barak, Yadah, Towdah, Shabach, Zamar, Halal, Tehillah (25 min)</p>
                        <span class="timeline-tag">Teaching</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="STAFF">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">8:02 PM</div>
                    <div class="timeline-content">
                        <h3>🎵 Heart of Worship</h3>
                        <p>Matt Redman — Leading into responsive reading</p>
                        <span class="timeline-tag">Worship</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="WORSHIP TEAM">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">8:09 PM</div>
                    <div class="timeline-content">
                        <h3>Responsive Reading</h3>
                        <p>Psalm 145:1-21 — Ladies and Men alternate verses</p>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="SAMUEL">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">8:16 PM</div>
                    <div class="timeline-content">
                        <h3>🎵 Build My Life</h3>
                        <p>Pat Barrett — Preparing hearts for communion</p>
                        <span class="timeline-tag">Worship</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="WORSHIP TEAM">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">8:19 PM</div>
                    <div class="timeline-content">
                        <h3>Communion</h3>
                        <p>1 Corinthians 11:23-26 — Remember Christ's sacrifice together</p>
                        <span class="timeline-tag">Lord's Table</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="NATHAN">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">8:24 PM</div>
                    <div class="timeline-content">
                        <h3>Prayer of St. Francis</h3>
                        <p>"Lord, make me an instrument of your peace..."</p>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="GORDON">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">8:26 PM</div>
                    <div class="timeline-content">
                        <h3>🎵 Reflective Closing Prayer</h3>
                        <p>Instrumental — Quietly praying ourselves out</p>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="GORDON">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-time">8:30 PM</div>
                    <div class="timeline-content">
                        <h3>Benediction</h3>
                        <p>Numbers 6:24-26 — "The LORD bless you and keep you..."</p>
                        <span class="timeline-tag">Closing</span>
                        <div class="responsible-field">
                            <label>👤 Responsible:</label>
                            <input type="text" class="responsible-input" placeholder="Assign someone..." value="GORDON">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Responsive Reading Section -->
    <section class="responsive-reading-section fade-in">
        <div class="responsive-reading-wrapper">
            <p class="section-label">Scripture</p>
            <h2 class="section-title">Psalm 145</h2>
            <p class="section-subtitle">A responsive reading — Ladies and Men alternate verses</p>

            <div class="responsive-reading-content">
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 1:</strong> I will extol you, my God and King, and bless your name forever and ever.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 2:</strong> Every day I will bless you and praise your name forever and ever.</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 3:</strong> Great is the LORD, and greatly to be praised, and his greatness is unsearchable.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 4:</strong> One generation shall commend your works to another, and shall declare your mighty acts.</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 5:</strong> On the glorious splendor of your majesty, and on your wondrous works, I will meditate.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 6:</strong> They shall speak of the might of your awesome deeds, and I will declare your greatness.</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 7:</strong> They shall pour forth the fame of your abundant goodness and shall sing aloud of your righteousness.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 8:</strong> The LORD is gracious and merciful, slow to anger and abounding in steadfast love.</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 9:</strong> The LORD is good to all, and his mercy is over all that he has made.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 10:</strong> All your works shall give thanks to you, O LORD, and all your saints shall bless you!</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 11:</strong> They shall speak of the glory of your kingdom and tell of your power,</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 12:</strong> to make known to the children of man your mighty deeds, and the glorious splendor of your kingdom.</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 13:</strong> Your kingdom is an everlasting kingdom, and your dominion endures throughout all generations.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 14:</strong> The LORD upholds all who are falling and raises up all who are bowed down.</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 15:</strong> The eyes of all look to you, and you give them their food in due season.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 16:</strong> You open your hand; you satisfy the desire of every living thing.</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 17:</strong> The LORD is righteous in all his ways and kind in all his works.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 18:</strong> The LORD is near to all who call on him, to all who call on him in truth.</p>
                </div>
                <div class="reading-verse ladies">
                    <span class="reader-label">👩 Ladies</span>
                    <p class="verse-text"><strong>Verse 19:</strong> He fulfills the desire of those who fear him; he also hears their cry and saves them.</p>
                </div>
                <div class="reading-verse men">
                    <span class="reader-label">👨 Men</span>
                    <p class="verse-text"><strong>Verse 20:</strong> The LORD preserves all who love him, but all the wicked he will destroy.</p>
                </div>
                <div class="reading-verse all">
                    <span class="reader-label">🙌 All Together</span>
                    <p class="verse-text"><strong>Verse 21:</strong> My mouth will speak the praise of the LORD, and let all flesh bless his holy name forever and ever.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Worship Types Slideshow -->
    <div class="slideshow-section">
        <div class="slideshow-header fade-in">
            <p class="section-label">Explore</p>
            <h2 class="section-title">Seven expressions.<br>One heart of worship.</h2>
            <p class="section-subtitle">Discover the beautiful diversity of how we can honor God through our lives.</p>
        </div>

        <div class="slideshow-container fade-in">
            <div class="slides-wrapper">
                <div class="slide-progress" id="slideProgress"></div>
                <div class="slides-track" id="slidesTrack">
                    <!-- Slide 1: Corporate Worship -->
                    <div class="slide active">
                        <span class="slide-number">1</span>
                        <span class="slide-icon">🎵</span>
                        <h3>Corporate Worship</h3>
                        <p>Gathering as one body to lift our voices in praise and adoration to our Creator.</p>
                        <div class="slide-content-grid">
                            <div class="slide-verses">
                                <h4>📖 Scripture</h4>
                                <div class="verse-item">
                                    <p>"Let the word of Christ dwell in you richly... singing psalms and hymns and spiritual songs, with thankfulness in your hearts to God."</p>
                                    <span class="verse-ref">— Colossians 3:16 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"Oh come, let us sing to the Lord; let us make a joyful noise to the rock of our salvation!"</p>
                                    <span class="verse-ref">— Psalm 95:1 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"Speaking to one another in psalms and hymns and spiritual songs, singing and making melody to the Lord with your heart."</p>
                                    <span class="verse-ref">— Ephesians 5:19 ESV</span>
                                </div>
                            </div>
                            <div class="slide-interactive">
                                <h4>💡 Engage</h4>
                                <div class="activity-box">
                                    <h5>🎯 Practical Examples</h5>
                                    <p>• Arrive early to prepare your heart before worship begins<br>• Close your eyes and focus on the lyrics, not the performance<br>• Raise your hands or kneel as physical expressions of surrender</p>
                                </div>
                                <div class="questions-box">
                                    <h5>🤔 Reflect</h5>
                                    <ul class="questions-list">
                                        <li>When was a time you felt deeply connected to God during corporate worship?</li>
                                        <li>What distractions typically prevent you from fully engaging in sung worship?</li>
                                        <li>How can you prepare your heart before coming to worship?</li>
                                    </ul>
                                    <span class="reveal-hint">👆 Tap questions one by one to reveal</span>
                                </div>
                                <!-- Cautions Section - Tap to Reveal -->
                                <button class="cautions-toggle" id="cautionsToggle" aria-expanded="false">
                                    ⚠️ Things to Be Careful About
                                    <span class="arrow">▼</span>
                                </button>
                                <div class="cautions-content" id="cautionsContent">
                                    <div class="cautions-list">
                                        <h5>🚫 Watch Out For</h5>
                                        <ul>
                                            <li>Making worship about the music style rather than the heart's posture toward God</li>
                                            <li>Focusing on how others perceive you instead of genuinely connecting with God</li>
                                            <li>Treating worship as entertainment or passive observation</li>
                                            <li>Allowing unconfessed sin to create a barrier between you and God</li>
                                            <li>Coming unprepared with a distracted mind and wandering thoughts</li>
                                            <li>Criticizing the worship team or comparing to other churches</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 2: Worship Through Prayer -->
                    <div class="slide">
                        <span class="slide-number">2</span>
                        <span class="slide-icon">🙏</span>
                        <h3>Worship Through Prayer</h3>
                        <p>Communicating with God, expressing our dependence, gratitude, and reverence.</p>
                        <div class="slide-content-grid">
                            <div class="slide-verses">
                                <h4>📖 Scripture</h4>
                                <div class="verse-item">
                                    <p>"Rejoice always, pray without ceasing, give thanks in all circumstances; for this is the will of God in Christ Jesus for you."</p>
                                    <span class="verse-ref">— 1 Thessalonians 5:16-18 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"Do not be anxious about anything, but in everything by prayer and supplication with thanksgiving let your requests be made known to God."</p>
                                    <span class="verse-ref">— Philippians 4:6 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"The Lord is near to all who call on him, to all who call on him in truth."</p>
                                    <span class="verse-ref">— Psalm 145:18 ESV</span>
                                </div>
                            </div>
                            <div class="slide-interactive">
                                <h4>💡 Engage</h4>
                                <div class="activity-box">
                                    <h5>🎯 Practical Examples</h5>
                                    <p>• Set a daily alarm as a reminder to pause and pray<br>• Keep a prayer journal to track requests and answered prayers<br>• Practice the A.C.T.S. model: Adoration, Confession, Thanksgiving, Supplication</p>
                                </div>
                                <div class="questions-box">
                                    <h5>🤔 Reflect</h5>
                                    <ul class="questions-list">
                                        <li>Is your prayer life more about asking or listening? How can you create more balance?</li>
                                        <li>What prevents you from praying more consistently throughout your day?</li>
                                        <li>How has prayer changed your perspective in a difficult season?</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 3: Worship Through Service -->
                    <div class="slide">
                        <span class="slide-number">3</span>
                        <span class="slide-icon">🤝</span>
                        <h3>Worship Through Service</h3>
                        <p>Serving others as an act of worship, recognizing that when we serve people, we serve God.</p>
                        <div class="slide-content-grid">
                            <div class="slide-verses">
                                <h4>📖 Scripture</h4>
                                <div class="verse-item">
                                    <p>"For you were called to freedom, brothers. Only do not use your freedom as an opportunity for the flesh, but through love serve one another."</p>
                                    <span class="verse-ref">— Galatians 5:13 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"As each has received a gift, use it to serve one another, as good stewards of God's varied grace."</p>
                                    <span class="verse-ref">— 1 Peter 4:10 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"And the King will answer them, 'Truly, I say to you, as you did it to one of the least of these my brothers, you did it to me.'"</p>
                                    <span class="verse-ref">— Matthew 25:40 ESV</span>
                                </div>
                            </div>
                            <div class="slide-interactive">
                                <h4>💡 Engage</h4>
                                <div class="activity-box">
                                    <h5>🎯 Practical Examples</h5>
                                    <p>• Volunteer at a local shelter or food bank monthly<br>• Offer to help a neighbor with yard work or errands<br>• Use your professional skills to mentor someone in need</p>
                                </div>
                                <div class="questions-box">
                                    <h5>🤔 Reflect</h5>
                                    <ul class="questions-list">
                                        <li>What gifts has God given you that could bless others?</li>
                                        <li>Is there someone you've been avoiding serving? Why?</li>
                                        <li>How can you serve with joy rather than obligation?</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 4: Worship Through Giving -->
                    <div class="slide">
                        <span class="slide-number">4</span>
                        <span class="slide-icon">💝</span>
                        <h3>Worship Through Giving</h3>
                        <p>Offering our resources, time, and talents as an expression of gratitude and trust.</p>
                        <div class="slide-content-grid">
                            <div class="slide-verses">
                                <h4>📖 Scripture</h4>
                                <div class="verse-item">
                                    <p>"Each one must give as he has decided in his heart, not reluctantly or under compulsion, for God loves a cheerful giver."</p>
                                    <span class="verse-ref">— 2 Corinthians 9:7 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"Honor the Lord with your wealth and with the firstfruits of all your produce."</p>
                                    <span class="verse-ref">— Proverbs 3:9 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"For where your treasure is, there your heart will be also."</p>
                                    <span class="verse-ref">— Matthew 6:21 ESV</span>
                                </div>
                            </div>
                            <div class="slide-interactive">
                                <h4>💡 Engage</h4>
                                <div class="activity-box">
                                    <h5>🎯 Practical Examples</h5>
                                    <p>• Set up automatic tithing to your local church<br>• Sponsor a child through a missions organization<br>• Give anonymously to someone facing financial hardship</p>
                                </div>
                                <div class="questions-box">
                                    <h5>🤔 Reflect</h5>
                                    <ul class="questions-list">
                                        <li>What does your spending reveal about your priorities?</li>
                                        <li>Do you give from abundance or from sacrifice? What's the difference?</li>
                                        <li>How has experiencing generosity from others impacted your faith?</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 5: Personal Devotion -->
                    <div class="slide">
                        <span class="slide-number">5</span>
                        <span class="slide-icon">📖</span>
                        <h3>Personal Devotion</h3>
                        <p>Spending intimate time with God through Scripture reading, meditation, and personal prayer.</p>
                        <div class="slide-content-grid">
                            <div class="slide-verses">
                                <h4>📖 Scripture</h4>
                                <div class="verse-item">
                                    <p>"But when you pray, go into your room and shut the door and pray to your Father who is in secret."</p>
                                    <span class="verse-ref">— Matthew 6:6 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"This Book of the Law shall not depart from your mouth, but you shall meditate on it day and night."</p>
                                    <span class="verse-ref">— Joshua 1:8 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"Be still, and know that I am God. I will be exalted among the nations, I will be exalted in the earth!"</p>
                                    <span class="verse-ref">— Psalm 46:10 ESV</span>
                                </div>
                            </div>
                            <div class="slide-interactive">
                                <h4>💡 Engage</h4>
                                <div class="activity-box">
                                    <h5>🎯 Practical Examples</h5>
                                    <p>• Start your day with 15 minutes of Bible reading before checking your phone<br>• Use a devotional app or reading plan for structure<br>• Memorize one verse each week and meditate on it daily</p>
                                </div>
                                <div class="questions-box">
                                    <h5>🤔 Reflect</h5>
                                    <ul class="questions-list">
                                        <li>What time of day do you feel most connected to God?</li>
                                        <li>What obstacles keep you from consistent devotional time?</li>
                                        <li>How has Scripture shaped a recent decision you made?</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 6: Living Sacrifice -->
                    <div class="slide">
                        <span class="slide-number">6</span>
                        <span class="slide-icon">🔥</span>
                        <h3>Living Sacrifice</h3>
                        <p>Offering our entire lives as an act of worship, surrendering ourselves to God's will daily.</p>
                        <div class="slide-content-grid">
                            <div class="slide-verses">
                                <h4>📖 Scripture</h4>
                                <div class="verse-item">
                                    <p>"I appeal to you therefore, brothers, by the mercies of God, to present your bodies as a living sacrifice, holy and acceptable to God."</p>
                                    <span class="verse-ref">— Romans 12:1 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"I have been crucified with Christ. It is no longer I who live, but Christ who lives in me."</p>
                                    <span class="verse-ref">— Galatians 2:20 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"And whoever does not take his cross and follow me is not worthy of me."</p>
                                    <span class="verse-ref">— Matthew 10:38 ESV</span>
                                </div>
                            </div>
                            <div class="slide-interactive">
                                <h4>💡 Engage</h4>
                                <div class="activity-box">
                                    <h5>🎯 Practical Examples</h5>
                                    <p>• Begin each morning by saying "Lord, today belongs to You"<br>• Fast from something you enjoy to refocus on God<br>• Make career and life decisions by seeking God's will first</p>
                                </div>
                                <div class="questions-box">
                                    <h5>🤔 Reflect</h5>
                                    <ul class="questions-list">
                                        <li>What areas of your life are you still holding back from God?</li>
                                        <li>What does daily surrender look like practically in your routine?</li>
                                        <li>How does the world's definition of success differ from God's?</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 7: Communion -->
                    <div class="slide">
                        <span class="slide-number">7</span>
                        <span class="slide-icon">🍷</span>
                        <h3>Communion</h3>
                        <p>Remembering Christ's sacrifice through the Lord's Supper, proclaiming His death until He comes again.</p>
                        <div class="slide-content-grid">
                            <div class="slide-verses">
                                <h4>📖 Scripture</h4>
                                <div class="verse-item">
                                    <p>"This is my body, which is for you. Do this in remembrance of me... This cup is the new covenant in my blood."</p>
                                    <span class="verse-ref">— 1 Corinthians 11:24-25 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"For as often as you eat this bread and drink the cup, you proclaim the Lord's death until he comes."</p>
                                    <span class="verse-ref">— 1 Corinthians 11:26 ESV</span>
                                </div>
                                <div class="verse-item">
                                    <p>"The cup of blessing that we bless, is it not a participation in the blood of Christ?"</p>
                                    <span class="verse-ref">— 1 Corinthians 10:16 ESV</span>
                                </div>
                            </div>
                            <div class="slide-interactive">
                                <h4>💡 Engage</h4>
                                <div class="activity-box">
                                    <h5>🎯 Practical Examples</h5>
                                    <p>• Take communion regularly at church with intentional reflection<br>• Before partaking, examine your heart and confess any known sin<br>• Reconcile with anyone you have conflict with before coming to the table</p>
                                </div>
                                <div class="questions-box">
                                    <h5>🤔 Reflect</h5>
                                    <ul class="questions-list">
                                        <li>What does Christ's sacrifice mean to you personally today?</li>
                                        <li>Is there anything you need to confess or reconcile before partaking?</li>
                                        <li>How does communion connect you to believers throughout history?</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Slide -->
                    <div class="slide summary-slide">
                        <span class="slide-icon">✨</span>
                        <h3>Seven Expressions</h3>
                        <p>Every aspect of our lives can become an offering of worship to our Creator.</p>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <span class="summary-icon">🎵</span>
                                <span class="summary-title">Corporate Worship</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-icon">🙏</span>
                                <span class="summary-title">Prayer</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-icon">🤝</span>
                                <span class="summary-title">Service</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-icon">💝</span>
                                <span class="summary-title">Giving</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-icon">📖</span>
                                <span class="summary-title">Devotion</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-icon">🔥</span>
                                <span class="summary-title">Living Sacrifice</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-icon">🍷</span>
                                <span class="summary-title">Communion</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <nav class="slide-nav">
                <button class="slide-arrow" id="prevBtn" aria-label="Previous slide">
                    <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15 18l-6-6 6-6"></path>
                    </svg>
                </button>

                <div class="slide-dots" id="slideDots"></div>

                <button class="slide-arrow" id="nextBtn" aria-label="Next slide">
                    <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 18l6-6-6-6"></path>
                    </svg>
                </button>
            </nav>

            <div class="slide-counter" style="text-align: center; margin-top: 1.5rem;">
                <span id="currentSlide">1</span> of <span id="totalSlides">7</span>
            </div>
        </div>
    </div>

    <!-- Bible Study: The Lord's Supper - Interactive Slideshow -->
    <div class="bible-slideshow-section">
        <div class="bible-slideshow-header fade-in">
            <p class="section-label">Bible Study</p>
            <h2 class="section-title">The Lord's Supper</h2>
            <p class="section-subtitle">Understanding the sacred ordinance of Communion and how to celebrate it with reverence.</p>
        </div>

        <div class="bible-slideshow-container fade-in">
            <div class="bible-slides-wrapper">
                <div class="bible-slide-progress" id="bibleSlideProgress"></div>
                <div class="bible-slides-track" id="bibleSlidesTrack">

                    <!-- Slide 1: How to Celebrate -->
                    <div class="bible-slide active">
                        <div class="bible-slide-header">
                            <div class="bible-slide-icon">🍷</div>
                            <div class="bible-slide-title-group">
                                <div class="bible-slide-number">Practice</div>
                                <h3>How Should We Celebrate?</h3>
                            </div>
                        </div>
                        <p class="bible-slide-description">Approaching the Lord's table requires intentional preparation of heart and mind. Here are four essential steps for meaningful participation.</p>
                        <div class="bible-steps-grid">
                            <div class="bible-step-item">
                                <div class="bible-step-number">1</div>
                                <h5>Examine Yourself</h5>
                                <p>You cannot participate with unconfessed sin—it would be a contradiction. The essence of communion is consecration.</p>
                                <span class="verse-ref">1 Corinthians 11:28</span>
                            </div>
                            <div class="bible-step-item">
                                <div class="bible-step-number">2</div>
                                <h5>Confess Your Sins</h5>
                                <p>Through proper confession, expel any lack of surrender. The hours before communion should be ones of deep reflection.</p>
                                <span class="verse-ref">1 John 1:9</span>
                            </div>
                            <div class="bible-step-item">
                                <div class="bible-step-number">3</div>
                                <h5>Ask for Discernment</h5>
                                <p>Ask God to illuminate any sin, wrong motives, or things left undone. Renew your attitude toward Him.</p>
                                <span class="verse-ref">Psalm 139:23-24</span>
                            </div>
                            <div class="bible-step-item">
                                <div class="bible-step-number">4</div>
                                <h5>Avoid Excess &amp; Disorder</h5>
                                <p>A lack of understanding causes us to lose the true solemn meaning. The Lord's Supper is sacred.</p>
                                <span class="verse-ref">1 Corinthians 11:20-22</span>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 2: A Serious Warning -->
                    <div class="bible-slide">
                        <div class="bible-slide-header">
                            <div class="bible-slide-icon">⚠️</div>
                            <div class="bible-slide-title-group">
                                <div class="bible-slide-number">Warning</div>
                                <h3>A Serious Warning</h3>
                            </div>
                        </div>
                        <p class="bible-slide-description">Scripture gives us a solemn warning about participating in communion unworthily—without discerning the body of the Lord.</p>
                        <div class="bible-slide-warning">
                            <h4>⚠️ Take Heed</h4>
                            <p>Participating in communion unworthily brings judgment upon oneself. The Scriptures tell us this has real consequences, including weakness, sickness, and even death among believers who do not examine themselves.</p>
                            <p>"For anyone who eats and drinks without discerning the body eats and drinks judgment on himself. That is why many of you are weak and ill, and some have died. But if we judged ourselves truly, we would not be judged."</p>
                            <span class="verse-ref">— 1 Corinthians 11:29-31 ESV</span>
                        </div>
                    </div>

                    <!-- Slide 3: The Reading Before Communion -->
                    <div class="bible-slide">
                        <div class="bible-slide-header">
                            <div class="bible-slide-icon">📖</div>
                            <div class="bible-slide-title-group">
                                <div class="bible-slide-number">Scripture Reading</div>
                                <h3>The Reading Before Communion</h3>
                            </div>
                        </div>
                        <p class="bible-slide-description">After self-examination, we are ready to celebrate. Read this passage together before partaking:</p>
                        <div class="bible-final-reading-box">
                            <blockquote>
                                "For I received from the Lord what I also delivered to you, that the Lord Jesus on the night when he was betrayed took bread, and when he had given thanks, he broke it, and said, 'This is my body, which is for you. Do this in remembrance of me.' In the same way also he took the cup, after supper, saying, 'This cup is the new covenant in my blood. Do this, as often as you drink it, in remembrance of me.' For as often as you eat this bread and drink the cup, you proclaim the Lord's death until he comes."
                                <span class="verse-ref">— 1 Corinthians 11:23-26 ESV</span>
                            </blockquote>
                        </div>
                    </div>

                    <!-- Slide 4: Summary -->
                    <div class="bible-slide bible-summary-slide">
                        <div class="bible-slide-icon" style="width: auto; height: auto; background: none; font-size: 4rem; margin: 0 auto 1.5rem;">✨</div>
                        <h3>The Lord's Supper</h3>
                        <p class="bible-slide-description" style="text-align: center; margin: 0 auto 2rem;">Remember these truths as you approach the Lord's table with reverence and gratitude.</p>
                        <div class="bible-summary-grid">
                            <div class="bible-summary-item">
                                <span class="icon">🍷</span>
                                <span class="title">Preparation</span>
                            </div>
                            <div class="bible-summary-item">
                                <span class="icon">⚠️</span>
                                <span class="title">Discernment</span>
                            </div>
                            <div class="bible-summary-item">
                                <span class="icon">📖</span>
                                <span class="title">Scripture</span>
                            </div>
                            <div class="bible-summary-item">
                                <span class="icon">✝️</span>
                                <span class="title">Remembrance</span>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <nav class="bible-slide-nav">
                <button class="bible-slide-arrow" id="biblePrevBtn" aria-label="Previous slide">
                    <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15 18l-6-6 6-6"></path>
                    </svg>
                </button>

                <div class="bible-slide-dots" id="bibleSlideDots"></div>

                <button class="bible-slide-arrow" id="bibleNextBtn" aria-label="Next slide">
                    <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 18l6-6-6-6"></path>
                    </svg>
                </button>
            </nav>

            <div class="bible-slide-counter">
                <span id="bibleCurrentSlide">1</span> of <span id="bibleTotalSlides">4</span>
            </div>
        </div>
    </div>

    <!-- Songs Section -->
    <div class="songs-section">
        <div class="songs-wrapper fade-in">
            <p class="section-label">Setlist</p>
            <h2 class="section-title">Tonight's worship.</h2>
            <p class="section-subtitle">Songs of God's greatness and goodness to guide our hearts.</p>

            <div class="songs-grid">
                <div class="song-item">
                    <div class="song-number">01</div>
                    <div class="song-info">
                        <div class="song-title">Goodness of God</div>
                        <div class="song-artist">Bethel Music</div>
                    </div>
                    <div class="play-icon">
                        <svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"></polygon></svg>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-number">01b</div>
                    <div class="song-info">
                        <div class="song-title">Firm Foundation (He Won't)</div>
                        <div class="song-artist">Cody Carnes</div>
                    </div>
                    <div class="play-icon">
                        <svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"></polygon></svg>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-number">02</div>
                    <div class="song-info">
                        <div class="song-title">Nothing Else</div>
                        <div class="song-artist">Cody Carnes</div>
                    </div>
                    <div class="play-icon">
                        <svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"></polygon></svg>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-number">03</div>
                    <div class="song-info">
                        <div class="song-title">Bless The Lord (10,000 Reasons)</div>
                        <div class="song-artist">Matt Redman</div>
                    </div>
                    <div class="play-icon">
                        <svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"></polygon></svg>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-number">04</div>
                    <div class="song-info">
                        <div class="song-title">Heart of Worship</div>
                        <div class="song-artist">Matt Redman</div>
                    </div>
                    <div class="play-icon">
                        <svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"></polygon></svg>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-number">05</div>
                    <div class="song-info">
                        <div class="song-title">Build My Life</div>
                        <div class="song-artist">Pat Barrett</div>
                    </div>
                    <div class="play-icon">
                        <svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"></polygon></svg>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-number">06</div>
                    <div class="song-info">
                        <div class="song-title">Reflective Closing</div>
                        <div class="song-artist">Instrumental</div>
                    </div>
                    <div class="play-icon">
                        <svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"></polygon></svg>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Presenter Controller Panel -->
    <div class="presenter-controller" id="presenterController">
        <div class="controller-inner">
            <div class="controller-header">
                <div class="controller-title">
                    🎛️ Presenter Controller
                </div>
                <div class="controller-status" id="controllerStatus">
                    Connected to display
                </div>
            </div>
            <div class="controller-content">
                <div class="controller-section">
                    <h4>Worship Expressions</h4>
                    <div class="current-slide-info" id="worshipSlideInfo">Slide 1: Corporate Worship</div>
                    <div class="slide-counter-ctrl" id="worshipSlideCounter">1 of 7</div>
                    <div class="controller-btns" style="margin-top: 0.75rem;">
                        <button class="ctrl-btn secondary" id="ctrlWorshipPrev">← Previous</button>
                        <button class="ctrl-btn primary" id="ctrlWorshipNext">Next →</button>
                        <button class="ctrl-btn secondary" id="ctrlShowWorship">Show</button>
                    </div>
                </div>
                <div class="controller-section">
                    <h4>Lord's Supper</h4>
                    <div class="current-slide-info" id="bibleSlideInfo">Slide 1: How Should We Celebrate?</div>
                    <div class="slide-counter-ctrl" id="bibleSlideCounter">1 of 4</div>
                    <div class="controller-btns" style="margin-top: 0.75rem;">
                        <button class="ctrl-btn secondary" id="ctrlBiblePrev">← Previous</button>
                        <button class="ctrl-btn primary" id="ctrlBibleNext">Next →</button>
                        <button class="ctrl-btn secondary" id="ctrlShowBible">Show</button>
                    </div>
                </div>
            </div>
            <div class="controller-btns" style="margin-top: 1rem; justify-content: center;">
                <button class="ctrl-btn danger" id="ctrlClosePresenter">Close Presenter Window</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="fade-in">
        <p>May our worship be a sweet aroma to the Lord 🕊️</p>
    </footer>

    <script>
        // Dark mode support
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Scroll animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.fade-in').forEach(el => {
            observer.observe(el);
        });

        // Slideshow functionality
        const slidesTrack = document.getElementById('slidesTrack');
        const slides = document.querySelectorAll('.slide');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const dotsContainer = document.getElementById('slideDots');
        const progress = document.getElementById('slideProgress');
        const currentSlideEl = document.getElementById('currentSlide');
        const totalSlidesEl = document.getElementById('totalSlides');

        let currentIndex = 0;
        const totalSlides = slides.length;

        // Set total slides
        totalSlidesEl.textContent = totalSlides;

        // Create dots
        for (let i = 0; i < totalSlides; i++) {
            const dot = document.createElement('button');
            dot.className = 'slide-dot' + (i === 0 ? ' active' : '');
            dot.setAttribute('aria-label', `Go to slide ${i + 1}`);
            dot.addEventListener('click', () => goToSlide(i));
            dotsContainer.appendChild(dot);
        }

        const dots = document.querySelectorAll('.slide-dot');

        function updateSlideshow() {
            // Move track
            slidesTrack.style.transform = `translateX(-${currentIndex * 100}%)`;

            // Update active states
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === currentIndex);
            });

            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === currentIndex);
            });

            // Update progress bar
            const progressPercent = ((currentIndex + 1) / totalSlides) * 100;
            progress.style.width = `${progressPercent}%`;

            // Update counter
            currentSlideEl.textContent = currentIndex + 1;

            // Update button states
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = currentIndex === totalSlides - 1;
        }

        function goToSlide(index) {
            currentIndex = index;
            updateSlideshow();
        }

        function nextSlide() {
            if (currentIndex < totalSlides - 1) {
                currentIndex++;
                updateSlideshow();
            }
        }

        function prevSlide() {
            if (currentIndex > 0) {
                currentIndex--;
                updateSlideshow();
            }
        }

        prevBtn.addEventListener('click', prevSlide);
        nextBtn.addEventListener('click', nextSlide);

        // Keyboard navigation - handle both slideshows
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                if (document.body.classList.contains('bible-presenter')) {
                    biblePrevSlide();
                } else {
                    prevSlide();
                }
            }
            if (e.key === 'ArrowRight') {
                if (document.body.classList.contains('bible-presenter')) {
                    bibleNextSlide();
                } else {
                    nextSlide();
                }
            }
        });

        // Touch/swipe support
        let touchStartX = 0;
        let touchEndX = 0;

        slidesTrack.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        }, { passive: true });

        slidesTrack.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, { passive: true });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    nextSlide();
                } else {
                    prevSlide();
                }
            }
        }

        // Initialize
        updateSlideshow();

        // Presenter Mode
        const presenterToggle = document.getElementById('presenterToggle');
        const presenterToggleBible = document.getElementById('presenterToggleBible');
        const exitPresenter = document.getElementById('exitPresenter');

        function enterPresenterMode() {
            document.body.classList.add('presenter-mode', 'worship-presenter');
            document.body.classList.remove('bible-presenter');
            // Scroll to slideshow section
            document.querySelector('.slideshow-section').scrollIntoView();
        }

        function enterBiblePresenterMode() {
            document.body.classList.add('presenter-mode', 'bible-presenter');
            document.body.classList.remove('worship-presenter');
            // Scroll to Bible slideshow section
            document.querySelector('.bible-slideshow-section').scrollIntoView();
        }

        function exitPresenterMode() {
            document.body.classList.remove('presenter-mode', 'worship-presenter', 'bible-presenter');
        }

        presenterToggle.addEventListener('click', enterPresenterMode);
        presenterToggleBible.addEventListener('click', enterBiblePresenterMode);
        exitPresenter.addEventListener('click', exitPresenterMode);

        // ESC key to exit presenter mode
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && document.body.classList.contains('presenter-mode')) {
                exitPresenterMode();
            }
        });

        // Bible Study Slideshow functionality
        const bibleSlidesTrack = document.getElementById('bibleSlidesTrack');
        const bibleSlides = document.querySelectorAll('.bible-slide');
        const biblePrevBtn = document.getElementById('biblePrevBtn');
        const bibleNextBtn = document.getElementById('bibleNextBtn');
        const bibleDotsContainer = document.getElementById('bibleSlideDots');
        const bibleProgress = document.getElementById('bibleSlideProgress');
        const bibleCurrentSlideEl = document.getElementById('bibleCurrentSlide');
        const bibleTotalSlidesEl = document.getElementById('bibleTotalSlides');

        let bibleCurrentIndex = 0;
        const bibleTotalSlides = bibleSlides.length;

        // Set total slides
        bibleTotalSlidesEl.textContent = bibleTotalSlides;

        // Create dots for Bible slideshow
        for (let i = 0; i < bibleTotalSlides; i++) {
            const dot = document.createElement('button');
            dot.className = 'bible-slide-dot' + (i === 0 ? ' active' : '');
            dot.setAttribute('aria-label', `Go to slide ${i + 1}`);
            dot.addEventListener('click', () => bibleGoToSlide(i));
            bibleDotsContainer.appendChild(dot);
        }

        const bibleDots = document.querySelectorAll('.bible-slide-dot');

        function updateBibleSlideshow() {
            // Move track
            bibleSlidesTrack.style.transform = `translateX(-${bibleCurrentIndex * 100}%)`;

            // Update active states
            bibleSlides.forEach((slide, i) => {
                slide.classList.toggle('active', i === bibleCurrentIndex);
            });

            bibleDots.forEach((dot, i) => {
                dot.classList.toggle('active', i === bibleCurrentIndex);
            });

            // Update progress bar
            const progressPercent = ((bibleCurrentIndex + 1) / bibleTotalSlides) * 100;
            bibleProgress.style.width = `${progressPercent}%`;

            // Update counter
            bibleCurrentSlideEl.textContent = bibleCurrentIndex + 1;

            // Update button states
            biblePrevBtn.disabled = bibleCurrentIndex === 0;
            bibleNextBtn.disabled = bibleCurrentIndex === bibleTotalSlides - 1;
        }

        function bibleGoToSlide(index) {
            bibleCurrentIndex = index;
            updateBibleSlideshow();
        }

        function bibleNextSlide() {
            if (bibleCurrentIndex < bibleTotalSlides - 1) {
                bibleCurrentIndex++;
                updateBibleSlideshow();
            }
        }

        function biblePrevSlide() {
            if (bibleCurrentIndex > 0) {
                bibleCurrentIndex--;
                updateBibleSlideshow();
            }
        }

        biblePrevBtn.addEventListener('click', biblePrevSlide);
        bibleNextBtn.addEventListener('click', bibleNextSlide);

        // Touch/swipe support for Bible slideshow
        let bibleTouchStartX = 0;
        let bibleTouchEndX = 0;

        bibleSlidesTrack.addEventListener('touchstart', (e) => {
            bibleTouchStartX = e.changedTouches[0].screenX;
        }, { passive: true });

        bibleSlidesTrack.addEventListener('touchend', (e) => {
            bibleTouchEndX = e.changedTouches[0].screenX;
            handleBibleSwipe();
        }, { passive: true });

        function handleBibleSwipe() {
            const swipeThreshold = 50;
            const diff = bibleTouchStartX - bibleTouchEndX;

            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    bibleNextSlide();
                } else {
                    biblePrevSlide();
                }
            }
        }

        // Initialize Bible slideshow
        updateBibleSlideshow();

        // Cautions Toggle Functionality
        const cautionsToggle = document.getElementById('cautionsToggle');
        const cautionsContent = document.getElementById('cautionsContent');

        cautionsToggle.addEventListener('click', function() {
            const isOpen = cautionsContent.classList.contains('open');
            cautionsContent.classList.toggle('open');
            cautionsToggle.classList.toggle('open');
            cautionsToggle.setAttribute('aria-expanded', !isOpen);
        });

        // Presenter Mode - One by One Question Reveal
        function setupQuestionReveal() {
            // Handle both regular questions-list and bible-questions-list
            const questionsLists = document.querySelectorAll('.questions-list, .bible-questions-list');

            questionsLists.forEach(list => {
                const questions = list.querySelectorAll('li');
                const hint = list.parentElement ? list.parentElement.querySelector('.reveal-hint') : null;

                // Reset all questions when slide changes
                questions.forEach(q => {
                    q.classList.remove('revealed');
                });

                // In presenter mode, hide questions initially and reveal on click
                if (document.body.classList.contains('presenter-mode')) {
                    let revealIndex = 0;

                    // Click on question box area or keypoint card to reveal next
                    const container = list.closest('.questions-box') || list.closest('.bible-keypoint-card');
                    if (container) {
                        container.onclick = function(e) {
                            if (revealIndex < questions.length) {
                                questions[revealIndex].classList.add('revealed');
                                revealIndex++;

                                // Hide hint after first reveal
                                if (hint && revealIndex === 1) {
                                    hint.classList.add('hidden');
                                }
                            }
                        };
                    }
                } else {
                    // Normal mode - show all questions
                    questions.forEach(q => {
                        q.classList.add('revealed');
                    });
                    if (hint) {
                        hint.classList.add('hidden');
                    }
                }
            });
        }

        // Reset question reveals when changing slides
        function resetQuestionReveals() {
            const allQuestions = document.querySelectorAll('.questions-list li, .bible-questions-list li');
            allQuestions.forEach(q => {
                q.classList.remove('revealed');
            });

            const allHints = document.querySelectorAll('.reveal-hint');
            allHints.forEach(h => {
                h.classList.remove('hidden');
            });
        }

        // Override slide change functions to reset questions
        const originalUpdateSlideshow = updateSlideshow;
        updateSlideshow = function() {
            originalUpdateSlideshow();
            if (document.body.classList.contains('presenter-mode')) {
                resetQuestionReveals();
                setupQuestionReveal();
            }
        };

        // Override Bible slideshow update to also handle questions
        const originalUpdateBibleSlideshow = updateBibleSlideshow;
        updateBibleSlideshow = function() {
            originalUpdateBibleSlideshow();
            if (document.body.classList.contains('presenter-mode')) {
                resetQuestionReveals();
                setupQuestionReveal();
            }
        };

        // Setup on presenter mode enter/exit
        const originalEnterPresenterMode = enterPresenterMode;
        enterPresenterMode = function() {
            originalEnterPresenterMode();
            resetQuestionReveals();
            setupQuestionReveal();
        };

        // Also setup for Bible presenter mode
        const originalEnterBiblePresenterMode = enterBiblePresenterMode;
        enterBiblePresenterMode = function() {
            originalEnterBiblePresenterMode();
            resetQuestionReveals();
            setupQuestionReveal();
        };

        const originalExitPresenterMode = exitPresenterMode;
        exitPresenterMode = function() {
            originalExitPresenterMode();
            // Show all questions in normal mode
            const allQuestions = document.querySelectorAll('.questions-list li, .bible-questions-list li');
            allQuestions.forEach(q => {
                q.classList.add('revealed');
            });
            const allHints = document.querySelectorAll('.reveal-hint');
            allHints.forEach(h => {
                h.classList.add('hidden');
            });
        };

        // Initial setup - show all questions in normal mode
        document.querySelectorAll('.questions-list li, .bible-questions-list li').forEach(q => {
            q.classList.add('revealed');
        });
        document.querySelectorAll('.reveal-hint').forEach(h => {
            h.classList.add('hidden');
        });

        // =====================
        // Schedule Drag & Drop
        // =====================
        const timelineGrid = document.getElementById('timelineGrid');
        let draggedItem = null;

        function initDragAndDrop() {
            const items = timelineGrid.querySelectorAll('.timeline-item');

            items.forEach((item, index) => {
                item.setAttribute('draggable', 'true');
                item.dataset.index = index;

                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('dragover', handleDragOver);
                item.addEventListener('dragenter', handleDragEnter);
                item.addEventListener('dragleave', handleDragLeave);
                item.addEventListener('drop', handleDrop);
            });
        }

        function handleDragStart(e) {
            draggedItem = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            document.querySelectorAll('.timeline-item').forEach(item => {
                item.classList.remove('drag-over');
            });
            draggedItem = null;
            recalculateTimes();
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleDragEnter(e) {
            if (this !== draggedItem) {
                this.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.stopPropagation();
            e.preventDefault();

            if (draggedItem !== this) {
                const allItems = [...timelineGrid.querySelectorAll('.timeline-item')];
                const draggedIdx = allItems.indexOf(draggedItem);
                const targetIdx = allItems.indexOf(this);

                if (draggedIdx < targetIdx) {
                    this.parentNode.insertBefore(draggedItem, this.nextSibling);
                } else {
                    this.parentNode.insertBefore(draggedItem, this);
                }
            }

            this.classList.remove('drag-over');
            return false;
        }

        function recalculateTimes() {
            const items = timelineGrid.querySelectorAll('.timeline-item');
            const durations = [3, 3, 4, 4, 4, 4, 3, 3, 4, 7, 7, 3, 5, 2]; // minutes per item
            let currentTime = new Date();
            currentTime.setHours(19, 30, 0, 0); // Start at 7:30 PM

            items.forEach((item, index) => {
                const timeEl = item.querySelector('.timeline-time');
                if (timeEl) {
                    const hours = currentTime.getHours();
                    const minutes = currentTime.getMinutes();
                    const period = hours >= 12 ? 'PM' : 'AM';
                    const displayHours = hours > 12 ? hours - 12 : hours;
                    const displayMinutes = minutes.toString().padStart(2, '0');
                    timeEl.textContent = `${displayHours}:${displayMinutes} ${period}`;

                    // Add duration for next item
                    const duration = durations[index] || 4;
                    currentTime.setMinutes(currentTime.getMinutes() + duration);
                }
            });
        }

        // Initialize drag and drop
        initDragAndDrop();

        // =====================
        // Save/Load Schedule
        // =====================
        const saveScheduleBtn = document.getElementById('saveScheduleBtn');
        const loadScheduleInput = document.getElementById('loadScheduleInput');

        function getScheduleData() {
            const items = timelineGrid.querySelectorAll('.timeline-item');
            const scheduleData = [];

            items.forEach(item => {
                const time = item.querySelector('.timeline-time')?.textContent || '';
                const title = item.querySelector('h3')?.textContent || '';
                const description = item.querySelector('p')?.textContent || '';
                const tag = item.querySelector('.timeline-tag')?.textContent || '';
                const responsible = item.querySelector('.responsible-input')?.value || '';

                scheduleData.push({ time, title, description, tag, responsible });
            });

            return {
                version: '1.0',
                theme: 'The Greatness & Goodness of God',
                exportedAt: new Date().toISOString(),
                schedule: scheduleData
            };
        }

        function saveSchedule() {
            const data = getScheduleData();
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `worship-schedule-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function loadSchedule(file) {
            const reader = new FileReader();

            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);

                    if (!data.schedule || !Array.isArray(data.schedule)) {
                        showNotification('Invalid schedule file format', 'error');
                        return;
                    }

                    // Clear existing items
                    timelineGrid.innerHTML = '';

                    // Rebuild schedule from loaded data
                    data.schedule.forEach(item => {
                        const timelineItem = document.createElement('div');
                        timelineItem.className = 'timeline-item';

                        let tagHtml = '';
                        if (item.tag) {
                            tagHtml = `<span class="timeline-tag">${item.tag}</span>`;
                        }

                        const responsibleValue = item.responsible || '';

                        timelineItem.innerHTML = `
                            <div class="timeline-time">${item.time}</div>
                            <div class="timeline-content">
                                <h3>${item.title}</h3>
                                <p>${item.description}</p>
                                ${tagHtml}
                                <div class="responsible-field">
                                    <label>👤 Responsible:</label>
                                    <input type="text" class="responsible-input" placeholder="Assign someone..." value="${responsibleValue}">
                                </div>
                            </div>
                        `;

                        timelineGrid.appendChild(timelineItem);
                    });

                    // Re-initialize drag and drop
                    initDragAndDrop();

                    showNotification('Schedule loaded successfully!', 'success');
                } catch (err) {
                    showNotification('Error reading schedule file', 'error');
                }
            };

            reader.readAsText(file);
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `schedule-notification ${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                padding: 1rem 2rem;
                border-radius: 12px;
                font-weight: 500;
                z-index: 9999;
                animation: slideUp 0.3s ease;
                ${type === 'success'
                    ? 'background: #10b981; color: white;'
                    : 'background: #ef4444; color: white;'}
            `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        saveScheduleBtn.addEventListener('click', saveSchedule);

        loadScheduleInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                loadSchedule(file);
                this.value = ''; // Reset input
            }
        });

        // Add notification animation
        const notificationStyle = document.createElement('style');
        notificationStyle.textContent = `
            @keyframes slideUp {
                from {
                    opacity: 0;
                    transform: translateX(-50%) translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateX(-50%) translateY(0);
                }
            }
        `;
        document.head.appendChild(notificationStyle);

        // =====================
        // Popup Presenter Mode
        // =====================
        let presenterWindow = null;
        let currentPresenterMode = 'worship'; // 'worship' or 'bible'
        const presenterPopupToggle = document.getElementById('presenterPopupToggle');
        const presenterController = document.getElementById('presenterController');
        const controllerStatus = document.getElementById('controllerStatus');

        // Slide titles for the controller
        const worshipSlideTitles = [
            'Corporate Worship', 'Prayer', 'Service & Acts of Kindness',
            'Giving', 'Devotion & Quiet Time', 'Surrender & Obedience', 'Communion'
        ];
        const bibleSlideTitles = [
            'Overview', 'A New Covenant', 'A Memorial of His Death',
            'Remember Your Death in Christ', 'Proclaiming His Death',
            'Early Church Practice', 'Received by Faith', 'How to Celebrate',
            'Self-Examination', 'Worship Preparation', 'Final Reflection'
        ];

        function updateControllerInfo() {
            const worshipSlideInfo = document.getElementById('worshipSlideInfo');
            const worshipSlideCounter = document.getElementById('worshipSlideCounter');
            const bibleSlideInfo = document.getElementById('bibleSlideInfo');
            const bibleSlideCounter = document.getElementById('bibleSlideCounter');

            if (worshipSlideInfo) {
                worshipSlideInfo.textContent = `Slide ${currentSlide + 1}: ${worshipSlideTitles[currentSlide] || 'Unknown'}`;
                worshipSlideCounter.textContent = `${currentSlide + 1} of ${totalSlides}`;
            }
            if (bibleSlideInfo) {
                bibleSlideInfo.textContent = `Slide ${currentBibleSlide + 1}: ${bibleSlideTitles[currentBibleSlide] || 'Unknown'}`;
                bibleSlideCounter.textContent = `${currentBibleSlide + 1} of ${totalBibleSlides}`;
            }
        }

        function generatePresenterHTML() {
            const darkMode = document.documentElement.classList.contains('dark');
            const slideshowSection = document.querySelector('.slideshow-section').outerHTML;
            const bibleSection = document.querySelector('.bible-slideshow-section').outerHTML;

            return `
<!DOCTYPE html>
<html lang="en" ${darkMode ? 'class="dark"' : ''}>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presenter Display - The Nest</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        ${document.querySelector('style').textContent}

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow: hidden;
        }

        body.presenter-mode .slideshow-section,
        body.presenter-mode .bible-slideshow-section {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 100 !important;
            padding-top: 2rem !important;
        }

        .presenter-toggle, .presenter-toggle-bible, .presenter-toggle-popup,
        .presenter-controller, .schedule-actions, .exit-presenter {
            display: none !important;
        }

        .presenter-section-label {
            display: block !important;
        }

        body.presenter-mode.worship-presenter .bible-slideshow-section,
        body.presenter-mode.bible-presenter .slideshow-section {
            display: none !important;
        }

        /* Full screen optimizations */
        .slide, .bible-slide {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
    </style>
</head>
<body class="presenter-mode ${currentPresenterMode === 'worship' ? 'worship-presenter' : 'bible-presenter'}">
    <div class="presenter-section-label ${currentPresenterMode === 'worship' ? 'worship-label' : 'bible-label'}">
        ${currentPresenterMode === 'worship' ? '🎵 Worship Expressions' : '✝️ The Lord\'s Supper'}
    </div>
    ${slideshowSection}
    ${bibleSection}
    <script>
        let currentSlide = ${currentSlide};
        let currentBibleSlide = ${currentBibleSlide};
        const totalSlides = ${totalSlides};
        const totalBibleSlides = ${totalBibleSlides};

        function updateSlideshow() {
            const track = document.getElementById('slidesTrack');
            if (track) {
                track.style.transform = 'translateX(-' + (currentSlide * 100) + '%)';
            }
        }

        function updateBibleSlideshow() {
            const track = document.getElementById('bibleSlidesTrack');
            if (track) {
                track.style.transform = 'translateX(-' + (currentBibleSlide * 100) + '%)';
            }
        }

        // Listen for messages from controller
        window.addEventListener('message', function(e) {
            const data = e.data;
            if (data.type === 'slide') {
                if (data.mode === 'worship') {
                    currentSlide = data.index;
                    updateSlideshow();
                } else if (data.mode === 'bible') {
                    currentBibleSlide = data.index;
                    updateBibleSlideshow();
                }
            } else if (data.type === 'switchMode') {
                document.body.classList.remove('worship-presenter', 'bible-presenter');
                document.body.classList.add(data.mode + '-presenter');

                const label = document.querySelector('.presenter-section-label');
                if (label) {
                    label.className = 'presenter-section-label ' + (data.mode === 'worship' ? 'worship-label' : 'bible-label');
                    label.textContent = data.mode === 'worship' ? '🎵 Worship Expressions' : '✝️ The Lord\\'s Supper';
                }
            } else if (data.type === 'close') {
                window.close();
            }
        });

        // Initial update
        updateSlideshow();
        updateBibleSlideshow();
    <\/script>
</body>
</html>`;
        }

        function openPresenterPopup() {
            // Close existing window if open
            if (presenterWindow && !presenterWindow.closed) {
                presenterWindow.close();
            }

            // Open new window
            presenterWindow = window.open('', 'PresenterDisplay',
                'width=1280,height=720,menubar=no,toolbar=no,location=no,status=no,resizable=yes');

            if (presenterWindow) {
                presenterWindow.document.write(generatePresenterHTML());
                presenterWindow.document.close();

                // Show controller panel
                presenterController.classList.add('active');
                updateControllerInfo();

                // Check if window is closed
                const checkWindow = setInterval(() => {
                    if (presenterWindow.closed) {
                        clearInterval(checkWindow);
                        presenterController.classList.remove('active');
                        controllerStatus.textContent = 'Disconnected';
                        controllerStatus.style.color = '#ef4444';
                    }
                }, 1000);

                showNotification('Presenter window opened! Drag it to your extended display.', 'success');
            } else {
                showNotification('Popup blocked! Please allow popups for this site.', 'error');
            }
        }

        function sendToPresenter(message) {
            if (presenterWindow && !presenterWindow.closed) {
                presenterWindow.postMessage(message, '*');
            }
        }

        // Controller button handlers
        presenterPopupToggle.addEventListener('click', openPresenterPopup);

        document.getElementById('ctrlWorshipPrev').addEventListener('click', () => {
            if (currentSlide > 0) {
                currentSlide--;
                updateSlideshow();
                sendToPresenter({ type: 'slide', mode: 'worship', index: currentSlide });
                updateControllerInfo();
            }
        });

        document.getElementById('ctrlWorshipNext').addEventListener('click', () => {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                updateSlideshow();
                sendToPresenter({ type: 'slide', mode: 'worship', index: currentSlide });
                updateControllerInfo();
            }
        });

        document.getElementById('ctrlBiblePrev').addEventListener('click', () => {
            if (currentBibleSlide > 0) {
                currentBibleSlide--;
                updateBibleSlideshow();
                sendToPresenter({ type: 'slide', mode: 'bible', index: currentBibleSlide });
                updateControllerInfo();
            }
        });

        document.getElementById('ctrlBibleNext').addEventListener('click', () => {
            if (currentBibleSlide < totalBibleSlides - 1) {
                currentBibleSlide++;
                updateBibleSlideshow();
                sendToPresenter({ type: 'slide', mode: 'bible', index: currentBibleSlide });
                updateControllerInfo();
            }
        });

        document.getElementById('ctrlShowWorship').addEventListener('click', () => {
            currentPresenterMode = 'worship';
            sendToPresenter({ type: 'switchMode', mode: 'worship' });
        });

        document.getElementById('ctrlShowBible').addEventListener('click', () => {
            currentPresenterMode = 'bible';
            sendToPresenter({ type: 'switchMode', mode: 'bible' });
        });

        document.getElementById('ctrlClosePresenter').addEventListener('click', () => {
            sendToPresenter({ type: 'close' });
            presenterController.classList.remove('active');
        });
    </script>


</body></html>